# 로그와 메트릭

## 1. 로그 (Log)

- 서버가 동작하는 동안 발생하는 상태와 동작 정보를 시간 순으로 기록한 데이터
- 시스템의 오류, 문제, 이벤트 등을 추적하고 문제 원인 분석에 사용
- 예: 에러 발생, 요청 처리 내역, 경고 메시지 등
- 주로 텍스트 형태로 기록됨

## 2. 메트릭 (Metric)

- 시스템 성능과 상태에 관한 통계적, 수치적 정보
- 시스템의 현재 상태를 빠르게 파악하고, 사업 현황 분석에 활용
- 예: CPU 사용량, 메모리 사용량, DAU(Daily Active Users), Retention 등
- 주기적으로 수집되어 시계열 데이터로 저장됨

---

# 경험 예시 (스프링 부트 프로젝트)

- 스프링 부트 액추에이터(Actuator)를 사용해 메트릭 생성
- Prometheus에 메트릭 저장, Grafana로 시각화
- 수집한 지표:
  - CPU 사용량, 메모리, JVM 힙 사용량
  - 톰캣 스레드 풀 상태
  - 데이터베이스 커넥션 풀 상태
  - error 레벨 로그 증가량
- 로그는 LogBack 사용, Loki에 7일간 보관
- 로그 추적을 위해 MDC (Mapped Diagnostic Context) 활용

---

# 메트릭 수집 이유

- CPU, 메모리, JVM 사용량: 서비스 안정성 모니터링 목적
- 톰캣 스레드 풀, 커넥션 풀 상태: 비정상 상황 조기 발견
- error 레벨 로그: 심각한 문제 신속 대응

---

# System.out.println vs 로깅 프레임워크

| 구분                    | System.out.println                      | 로깅 프레임워크 (예: LogBack)            |
|-------------------------|---------------------------------------|------------------------------------------|
| 로그 레벨 설정           | 불가능                               | 가능 (ERROR, WARN, INFO, DEBUG 등)        |
| 환경별 로그 필터링       | 어려움                               | 용이                                     |
| 성능 영향               | 대기 시간 발생                       | 비동기 처리, 성능 최적화 가능              |
| 로그 저장 및 관리       | 별도 기능 없음                       | 로그 파일 분할, 보관 정책, 중앙집중화 지원 |
| 운영 효율성             | 낮음                                | 높음                                     |

- System.out.println은 간단하지만 서비스 운영에 적합하지 않음
- 로깅 프레임워크는 로그의 양과 품질 관리에 유리하여 운영 시 필수적임
